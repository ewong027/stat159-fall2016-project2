---
output: pdf_document
---
```{r, echo = FALSE, include = FALSE}
scaled_credit <- read.csv("../data/datasets/scaled-credit.csv")

load("../data/RData-files/ols-regression.RData")
load("../data/RData-files/ridge-regression.RData")
load("../data/RData-files/lasso-regression.RData")
load("../data/RData-files/pc-regression.RData")
load("../data/RData-files/pls-regression.RData")

library(xtable)
library(png)
library(grid)
library(ggplot2)
library(reshape)
```


```{r, results = "asis", echo = FALSE, message = FALSE}
ridge_coef_mat <- as.matrix(ridge_coef_full)
coef_matrix <- matrix(data = c(as.numeric(ols_reg$coefficients), 
                                  as.numeric(ridge_coef_mat),
                                  as.numeric(lasso_coef_full),0, 
                                  as.numeric(pc_coef_full), 0, 
                                  as.numeric(pls_coef_full)), 
                                  nrow = 12, ncol = 5)

colnames(coef_matrix) <- c('OLS', 'Ridge', 'Lasso', 'PC', 'PLS')
rownames(coef_matrix) <- c('Intercept', 'Income', 'Limit', 'Rating', 'Cards',
                           'Age', 'Education', 'GenderFemale', 'StudentYes',
                           'MarriedYes', 'EthnicityAsian',
                           'EthnicityCaucasian')
print(xtable(coef_matrix, caption = 'Regression Coefficients', digits = 4),
      type = 'latex', comment = FALSE)
```

```{r results= 'asis', echo = FALSE}
Regression <- c('OLS','Ridge', 'Lasso', 'PCR', 'PLSR')
MSE <- c(ols_MSE, ridge_MSE, lasso_mse, pc_MSE, pls_mse)
mse_chart <- data.frame(Regression, MSE)
mse_tbl <- xtable(mse_chart,
               caption = 'Test MSE Values for the Regression Techniques',
               digits = 7)

print(mse_tbl, caption.placement = 'top',
      comment = getOption("xtable.comment", FALSE),
      include.rownames = FALSE)
```


```{r, echo = FALSE}
coef_df <- data.frame(type = colnames(coef_matrix), t(coef_matrix))
coef_melt <- melt(coef_df, id.vars = 'type')
coef_melt$type <- factor(coef_melt$type, levels = coef_melt$type)

ggplot(coef_melt, aes(type,value))+
  geom_bar(aes(fill = variable), stat = 'identity')+
  facet_wrap(~variable, scales = 'free')
```

